<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/bootstrap.css">
    <script src="../js/jquery-3.7.1.js"></script>
    <script src="../js/bootstrap.js"></script>

    <style>
        *{
            box-sizing: border-box;
        }
        .container{
            border: 1px solid black;
            padding: 0;
        }
        .modal .modal-dialog{
            width: 750px;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <img src="../img/header.JPG" alt="h1" class="img-fluid" style="width: 100%;">
        </header>
        <nav>
            <ul class="nav">
                <li class="nav-item"><a class="nav-link" href="#">Trang chủ</a></li>
                <li class="nav-item"><a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#myModal">Đăng ký tham gia</a></li>
            </ul>
        </nav>
        <section>
            <div class="table-responsive">
                <h2 class="text-center fs-5">DANH SÁCH HỌC VIÊN ĐĂNG KÝ</h2>
                <table class="table table-primary table-bordered" id="tblinfo">
                    <thead>
                        <tr>
                            <th scope="col">STT</th>
                            <th scope="col">Họ và tên</th>
                            <th scope="col">Giới tính</th>
                            <th>Số điện thoại</th>
                            <th>Ngày sinh</th>
                            <th>Địa chỉ</th>
                            <th>Khóa học</th>
                            <th>Học phí</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                    </tbody>
                </table>
            </div>

        </section>
        <footer class="text-center">
            <p>STT13_LeMinhDuc</p>
        </footer>
    </div>

    <!-- modal -->
     <div class="modal" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content" style="width: 800px;">
                <div class="modal-header">
                    <h4>THÔNG TIN HỌC VIÊN</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <label for="ten" class="col-4 form-label fw-bold text-end">Họ và tên</label>
                        <div class="col-8">
                            <input type="text" id="ten" name="ten" class="form-control" onblur="ktHoTen()" required>
                            <span class="text-danger" id="errten">*</span>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label class="col-4 form-label fw-bold text-end">Giới tính</label>
                        <div class="col-8">
                            <div class="form-check form-check-inline">
                                <input type="radio" id="nam" name="gt" class="form-check-input" value="nam">
                                <label for="nam" class="form-check-label">Nam</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input type="radio" id="nu" name="gt" class="form-check-input" value="nữ">
                                <label for="nu" class="form-check-label">Nữ</label>
                            </div>
                        </div>
                    </div>


                    <div class="row mb-3">
                        <label for="sdt" class="col-4 form-label fw-bold text-end">Số điện thoại</label>
                        <div class="col-8">
                            <input type="text" id="sdt" name="sdt" class="form-control" onblur="ktSDT()" required>
                            <span class="text-danger" id="errsdt">*</span>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label for="nsinh" class="col-4 form-label fw-bold text-end">Ngày sinh</label>
                        <div class="col-8">
                            <input type="date" id="nsinh" name="nsinh" class="form-control" onblur="ktNS()" required>
                            <span class="text-danger" id="errns">*</span>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label for="dc" class="col-4 form-label fw-bold text-end">Địa chỉ</label>
                        <div class="col-8">
                            <input type="text" id="dc" name="dc" class="form-control" required>
                            
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label for="chon" class="col-4 form-label fw-bold text-end">Bạn muốn tham gia hóa học nào?</label>
                        <div class="col-8">
                            <select id="chon" class="form-select" onchange="updateHP()">
                                <option value="2 tuần">2 tuần</option>
                                <option value="4 tuần">4 tuần</option>
                                <option value="6 tuần">6 tuần</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <label for="hp" class="col-4 form-label fw-bold text-end">Học phí</label>
                        <div class="col-8">
                            <input type="text" id="hp" name="hp" class="form-control" readonly>
                            
                        </div>
                    </div>

                    
                    <div class="row mb-3">
                        <label for="anh" class="col-4 form-label fw-bold text-end">Ảnh đại diện</label>
                        <div class="col-8">
                            <input type="file" id="anh" name="anh" class="form-control" onblur="ktAnh()" required>
                            <span class="text-danger" id="erranh">*</span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success" style="width: 100%;" onclick="Luu()">Lưu</button>
                </div>
            </div>
        </div>
     </div>

     <script>
        document.addEventListener("DOMContentLoaded", function(){
            updateHP();
        });

        function updateHP(){
            let khoaHoc= document.getElementById("chon").value;
            let hp= document.getElementById("hp");

            switch(khoaHoc){
                case "2 tuần":
                    hp.value= "5,000,000";
                    break;

                case "4 tuần":
                    hp.value= "8,000,000";
                    break;
                case "6 tuần":
                    hp.value= "9,000,000";
                    break;

                default:
                    hp.value="";
            }
        }

        function ktHoTen(){
            let hoten= document.getElementById("ten").value;
           
            let mau= /^[A-Z]{1}[A-Za-z]*(\s[A-Z]{1}[A-Za-z]*)+$/;
            if(mau.test(hoten)){
                document.getElementById("errten").innerHTML= "ok";
                return true;
            }else{
                document.getElementById("errten").innerHTML= "tên phải theo mẫu (vd: Le Minh Duc)";
                return false;
            }
        }

        function ktSDT(){
            let sdt= document.getElementById("sdt").value;
            let loisdt= document.getElementById("errsdt");
            let mau= /^(\d{3}-)\d{6}$/;
            if(mau.test(sdt)){
                loisdt.innerHTML= "ok";
                return true;
            }else{
                loisdt.innerHTML= "sdt phải theo mẫu (vd: 987-123456)";
                return false;
            }
        }

        function ktNS(){
            let nsinh= document.getElementById("nsinh").value;
            let loins= document.getElementById("errns");
            let namHT= new Date();
            let namSinh= new Date(nsinh);
            let tuoi= namHT.getFullYear()- namSinh.getFullYear();

            // let diffMonth= namHT.getMonth()- namSinh.getMonth();
            // let sinhNhat= (diffMonth<0 || (diffMonth==0 && namHT.getDate()< namSinh.getDate())) ? tuoi-1: tuoi;

            if(tuoi <=15 || tuoi >18){
                loins.innerHTML= "tuôi trên 15 và dưới 18";
                return false;
            }
            else{
                loins.innerHTML= "ok";
                return true;
            }

            
        }

        function ktAnh(){
            let anh= document.getElementById("anh").files[0];
            if(!anh){
                document.getElementById("erranh").innerHTML= "vui lòng chọn ảnh";
                return false;
            }else{
                return true;
            }
        }

        // function formatDate(dateStr){
        //     let date= new Date(dateStr);
        //     return data.toLocaleDateString("vi-VN");
        // }

        let count=1;
        function Luu(){

            
            let hoten= document.getElementById("ten").value;
            let radios= document.getElementsByName("gt");
            let gioitinh= null;
            for(let radio of radios){
                if(radio.checked){
                    gioitinh= radio.value;
                    break;
                }
            }
            let sdt= document.getElementById("sdt").value;
            let ns= document.getElementById("nsinh").value;
            let dchi= document.getElementById("dc").value;
            let khoahoc= document.getElementById("chon").value;
            let hp= document.getElementById("hp").value;
            let anh= document.getElementById("anh").files[0];
            let imgURL= URL.createObjectURL(anh);

            let table= document.getElementById("tblinfo").getElementsByTagName("tbody")[0];
            let newrow= table.insertRow();

            // newrow.innerHTML=`
            //     <td>${count++}</td>
            //     <td>${hoten}</td>
            //     <td>${gioitinh}</td>
            //     <td>${sdt}</td>
            //     <td>${ns}</td>
            //     <td>${dchi}</td>
            //     <td>${khoahoc}</td>
            //     <td>${hp}</td>
            //     <td><img src="${imgURL}" alt="anh" style="width:50px;height:50px;object-fit:cover"></td>
            
            // `;

            newrow.insertCell(0).innerHTML= count;
            newrow.insertCell(1).innerHTML=hoten;
            newrow.insertCell(2).innerHTML=gioitinh;
            newrow.insertCell(3).innerHTML=sdt;

            newrow.insertCell(4).innerHTML= ns;
            newrow.insertCell(5).innerHTML=dchi;
            newrow.insertCell(6).innerHTML=khoahoc;
            newrow.insertCell(7).innerHTML=hp;
            newrow.insertCell(8).textContent= anh.name;
            count++;
        }

     </script>
</body>

</html>